


Ngnix用于I/O密集性服务

**配置模块**：
实现了最基本的配置项的解析功能

**核心模块**：
使得非模块化的框架代码中关注如何调用6个核心模块

**事件模块**：
HTTP模块和mail模块的基础

![基本架构](http://i.imgur.com/bSn82YX.png)

## 核心进程

![核心进程](http://i.imgur.com/EzUQyVs.png)

正常执行中的nginx会有多个进程，最基本的有master process（监控进程，也叫做主进程）和woker process（工作进程），还可能有cache相关进程。 

**master进程**：监控进程充当整个进程组与用户的交互接口，同时对进程进行监护。通过管理worker进程来实现重启服务、平滑升级、更换日志文件、配置文件实时生效等功能。 

**worker进程**：处理基本的网络事件

**处理过程**：master（master进程会先建立好需要listen的socket）——–fork生成子进程workers，继承socket（此时workers子进程们都继承了父进程master的所有属性，当然也包括已经建立好的socket

**惊群现象**：当一个连接进来后，所有在accept在这个socket上面的进程，都会收到通知，而只有一个进程可以accept这个连接，其它的则accept失败。

## Nginx事件处理机制

1. Ngnix采用的是异步非阻塞的事件处理机制，由进程循环处理多个准备好的事件，从而实现高并发和轻量级。
2. 采用信号事务机制通知worker进行工作 

## Nginx与Apache

### 在高并发上的区别

- Apache，每个请求都会独占一个工作线程，阻塞，当并发数到达几千时，就同时有几千的线程在处理请求了。
- Nginx来讲，一个进程只有一个主线程，通过异步非阻塞的事件处理机制，实现了循环处理多个准备好的事件，从而实现轻量级和高并发。

### 服务类型

**Nginx**

- 主要作为反向代理
- 网络模式：事件驱动
- 适合IO密集型服务
- 静态文件的处理
- 负载能力高

**Apache**

- 适合CPU密集型服务